<!DOCTYPE html>
<html>
<head>
  <title>Life Change – Custom Plans</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/mobilenet"></script>

  <style>
    body { 
      font-family: Arial; 
      max-width: 800px; 
      margin: auto; 
      padding: 20px; 
      background: #f5f5f5;
    }
    h1 { text-align: center; }
    .box {
      background: white;
      padding: 20px;
      border-radius: 10px;
      margin-top: 20px;
      box-shadow: 0 0 10px #0002;
    }
    textarea {
      width: 100%;
      height: 60px;
      padding: 10px;
      font-size: 16px;
    }
    button {
      padding: 10px 20px;
      font-size: 16px;
      margin-top: 10px;
      cursor: pointer;
      border-radius: 6px;
      background: #0078ff;
      color: white;
      border: none;
    }
    #preview { width: 200px; margin-top: 10px; border-radius: 10px; }
    #bar { height: 20px; background: #ddd; border-radius: 10px; overflow: hidden; }
    #bar-inner { height: 100%; width: 0%; background: green; }
  </style>
</head>
<body>

<h1>Life Change</h1>
<p style="text-align:center;">Your personalized daily life-improving system</p>

<!-- Goal Input -->
<div class="box">
  <h2>1. What do you want to get better at?</h2>
  <textarea id="goal" placeholder="Example: get better at basketball, lose weight, gain muscle..."></textarea>
  <button onclick="generatePlan()">Generate My Plan</button>
</div>

<!-- Workout Plan -->
<div class="box">
  <h2>Your Daily Workout Plan</h2>
  <div id="workout">Enter your goal above</div>
</div>

<!-- Meal Plan -->
<div class="box">
  <h2>Your Daily Eating Plan</h2>
  <div id="meals">Enter your goal above</div>
</div>

<!-- Food Analyzer -->
<div class="box">
  <h2>Rate Your Food</h2>
  <input type="file" id="fileInput" accept="image/*"><br>
  <img id="preview">
  <h3>Prediction:</h3>
  <div id="preds">None</div>
  <h3>Health Score:</h3>
  <div id="score">—</div>
  <div id="bar"><div id="bar-inner"></div></div>
</div>

<script>
/* ---------------------------
    AI MODEL FOR FOOD RATING
----------------------------*/
let model;
const SCORES = {
  "salad":9,"leaf":9,"spinach":10,"kale":10,"broccoli":10,
  "apple":10,"banana":9,"orange":10,"berry":10,
  "chicken":7,"fish":8,"salmon":9,
  "rice":5,"pasta":5,"pizza":3,"burger":3,
  "fries":2,"fried":2,"donut":1,"ice cream":1,"cake":1,"cookie":1,"soda":1
};

async function loadModel() { model = await mobilenet.load(); }
loadModel();

// Handle image upload
document.getElementById("fileInput").addEventListener("change", function() {
  const file = this.files[0];
  const img = document.getElementById("preview");
  img.src = URL.createObjectURL(file);

  img.onload = async () => {
    const predictions = await model.classify(img);
    document.getElementById("preds").innerHTML =
      predictions.map(p => `${p.className} — ${(p.probability*100).toFixed(1)}%`).join("<br>");

    let labels = predictions.map(p => p.className.toLowerCase());
    let scoreList = [];

    labels.forEach(l => {
      for (const key in SCORES) {
        if (l.includes(key)) scoreList.push(SCORES[key]);
      }
    });

    let finalScore = scoreList.length ? scoreList.reduce((a,b)=>a+b)/scoreList.length : 5;
    finalScore = Math.round(finalScore * 10)/10;

    document.getElementById("score").innerText = finalScore + "/10";
    document.getElementById("bar-inner").style.width = (finalScore * 10) + "%";
  };
});

/* ---------------------------
    CUSTOM DAILY PLAN MAKER
----------------------------*/
function generatePlan() {
  const goal = document.getElementById("goal").value.toLowerCase();
  let workout = "";
  let meals = "";

  if (goal.includes("basketball")) {
    workout = `
      • 20 min ball-handling  
      • 10 min form shooting  
      • 30 min conditioning (sprints + suicides)  
      • 50 pushups, 60 squats  
      • 10 min core  
    `;
    meals = `
      • Breakfast: eggs + fruit  
      • Lunch: chicken/rice  
      • Dinner: lean protein + vegetables  
      • Snacks: fruit, nuts  
      • Avoid: soda, fried foods  
    `;
  } 
  else if (goal.includes("lose") || goal.includes("weight")) {
    workout = `
      • 40 min walking/jogging  
      • 3×15 squats  
      • 3×10 pushups  
      • 10 min core  
    `;
    meals = `
      • High protein breakfast  
      • Low-calorie lunches (chicken/salad)  
      • No sugary drinks  
      • Drink 8–10 cups of water  
    `;
  }
  else if (goal.includes("muscle") || goal.includes("strong")) {
    workout = `
      • Push day: pushups, dips, shoulder presses  
      • Pull day: rows, curls  
      • Legs: squats, lunges  
      • Core: planks, leg raises  
    `;
    meals = `
      • High protein: eggs, chicken, beef, beans  
      • Rice/potatoes for carbs  
      • 1 gallon water  
      • 120–160g protein daily  
    `;
  }
  else {
    workout = `
      • 20 min walk  
      • 20 min strength training  
      • 10 min stretching  
    `;
    meals = `
      • Whole foods  
      • Vegetables every meal  
      • Drink water  
      • Avoid sugar  
    `;
  }

  document.getElementById("workout").innerText = workout;
  document.getElementById("meals").innerText = meals;
}
</script>

</body>
</html>
